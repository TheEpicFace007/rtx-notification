const DesknotifyAPI = {

	/**
	 * @name Desknotify.notify
	 * @param data {Object} It can specify: title {String}, message {String} and icon {String}
	 * @return {Object:Promise} Returns a promise, so we can operate after the notification is sent, or when an error happens.
	 * @description Sends a notification to the desktop with the title, the message and the icon specified.
	 */
	notify: function(data) {
		require('promise.prototype.finally').shim();
		return new Promise(function(resolve, reject) {
			const noop = function() {};
			const parameters = Object.assign({
				title: "Desktop notification",
				message: "Just that everything is fine...",
				icon: __dirname + "/../icons/peace.png",
				wait: true
			}, data || {});
			if(parameters.icon && parameters.icon[0] === "#") {
				parameters.icon = require("path").resolve(__dirname, "../icons", parameters.icon.substr(1));
			}
			const notifier = require("node-notifier").notify(parameters, function(error, response) {
				if(error) {
					return reject(error);
				}
				resolve(response);
			});
		});
	}
};

module.exports = DesknotifyAPI;